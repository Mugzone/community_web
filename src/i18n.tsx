import { createContext, useContext, useEffect, useMemo, useState, type ReactNode } from 'react'

export type Locale = 'en-US' | 'zh-CN' | 'ja'

type TranslationDict = Record<Locale, Record<string, string>>
type TranslateVars = Record<string, string | number>

const fallbackLocale: Locale = 'en-US'
const storageKey = 'malody.lang'
const supportedLocales: Locale[] = ['en-US', 'zh-CN', 'ja']

const translations: TranslationDict = {
  'en-US': {
    'nav.home': 'Home',
    'nav.charts': 'Charts',
    'nav.skins': 'Skins',
    'nav.wiki': 'Wiki',
    'nav.events': 'Events',
    'nav.players': 'Players',
    'nav.talk': 'Talk',
    'topbar.signIn': 'Sign in',
    'topbar.signUp': 'Sign up',
    'topbar.signOut': 'Sign out',
    'topbar.hi': 'Hi, {{name}}',
    'banner.featured': 'Featured',
    'home.hero.title': 'Malody Community',
    'home.hero.desc':
      'Malody is a cross-platform music game which is developed by a group of dedicated volunteers. The charts here are created by players from all around the world. Join us now to start a new journey.',
    'home.hero.communityEyebrow': 'Community',
    'home.hero.cardTitle': 'Weekly show & new arrivals',
    'home.hero.cardDesc': 'Featuring curated charts every week. Submit yours and climb the rankings.',
    'home.hero.chip.multi': 'Multi-mode',
    'home.hero.chip.cross': 'Cross-platform',
    'home.hero.chip.creator': 'Creator friendly',
    'home.hero.cta.primary': 'Get Malody V',
    'home.hero.cta.secondary': 'Learn more',
    'home.section.news': 'News & Help',
    'home.section.newArrival': 'New Arrival',
    'home.section.weeklyShow': 'Weekly Show',
    'home.section.more': 'More →',
    'charts.eyebrow': 'Charts',
    'charts.title': 'Browse all charts',
    'charts.desc': 'Filter by mode, level, freestyle, or keyword.',
    'charts.filter.title': 'Filters',
    'charts.filter.keyword': 'Keyword',
    'charts.filter.keywordPlaceholder': 'Song, artist, tag...',
    'charts.filter.mode': 'Mode',
    'charts.filter.level': 'Level range',
    'charts.filter.levelMin': 'Min level',
    'charts.filter.levelMax': 'Max level',
    'charts.filter.free': 'Freestyle only',
    'charts.filter.beta': 'Include beta charts',
    'charts.filter.apply': 'Apply filters',
    'charts.filter.reset': 'Reset',
    'charts.mode.all': 'All modes',
    'charts.listTitle': 'Charts',
    'charts.results.count': 'Showing {{count}} charts',
    'charts.results.empty': 'No charts match your filters.',
    'charts.error.fetch': 'Unable to load charts right now',
    'charts.error.network': 'Network error, please try again',
    'charts.loading': 'Loading...',
    'charts.loadMore': 'Load more',
    'charts.card.length': 'Length {{value}}',
    'charts.card.lengthUnknown': 'Length —',
    'charts.card.bpm': '{{value}} BPM',
    'charts.card.bpmUnknown': 'BPM —',
    'charts.card.updated': 'Updated {{time}}',
    'charts.card.updatedUnknown': 'Updated —',
    'charts.card.view': 'View chart',
    'charts.badge.freestyle': 'Freestyle',
    'charts.badge.beta': 'Beta',
    'events.eyebrow': 'Events',
    'events.title': 'Community events',
    'events.desc': 'Join ongoing events or browse past challenges.',
    'events.filter.activeOnly': 'Show active only',
    'events.highlight.title': 'What to expect',
    'events.highlight.desc': 'Events feature curated charts and unique rules. Jump in and compete.',
    'events.listTitle': 'Event list',
    'events.results.count': 'Showing {{count}} events',
    'events.results.empty': 'No events yet.',
    'events.error.fetch': 'Unable to load events',
    'events.error.network': 'Network error, please try again',
    'events.loading': 'Loading...',
    'events.loadMore': 'Load more',
    'events.status.upcoming': 'Upcoming',
    'events.status.ongoing': 'Ongoing',
    'events.status.ended': 'Ended',
    'events.status.unknown': 'Scheduled',
    'events.time.unknown': 'TBD',
    'events.name.untitled': 'Untitled event',
    'skins.eyebrow': 'Skins',
    'skins.title': 'Find your look',
    'skins.desc': 'Search and browse skins across modes.',
    'skins.filter.title': 'Filters',
    'skins.filter.keyword': 'Keyword',
    'skins.filter.keywordPlaceholder': 'Skin name...',
    'skins.filter.mode': 'Mode',
    'skins.filter.apply': 'Apply filters',
    'skins.filter.reset': 'Reset',
    'skins.mode.all': 'All modes',
    'skins.listTitle': 'Skins',
    'skins.results.count': 'Showing {{count}} skins',
    'skins.results.empty': 'No skins match your filters.',
    'skins.error.fetch': 'Unable to load skins',
    'skins.error.network': 'Network error, please try again',
    'skins.loading': 'Loading...',
    'skins.loadMore': 'Load more',
    'skins.price.value': '{{value}} Gold',
    'skins.price.free': 'Free',
    'skins.sales': '{{value}} sales',
    'skins.creator': 'By {{name}}',
    'skins.creator.unknown': 'Unknown creator',
    'skins.badge.owned': 'Owned',
    'skinDetail.eyebrow': 'Skin',
    'skinDetail.placeholder.name': 'Loading skin...',
    'skinDetail.creator': 'By {{name}}',
    'skinDetail.creator.unknown': 'Unknown creator',
    'skinDetail.sales': '{{value}} sales',
    'skinDetail.updated': 'Updated {{time}}',
    'skinDetail.meta.id': 'Skin #{{id}}',
    'skinDetail.error.missingId': 'Missing skin id',
    'skinDetail.error.notFound': 'Skin not found',
    'skinDetail.error.load': 'Unable to load skin right now',
    'skinDetail.error.auth': 'Please sign in to continue',
    'skinDetail.error.insufficient': 'Not enough gold to buy this skin',
    'skinDetail.error.buy': 'Purchase failed, please try again',
    'skinDetail.purchase.title': 'Purchase / download',
    'skinDetail.purchase.desc': 'Spend gold to unlock this skin for your account.',
    'skinDetail.purchase.freeDesc': 'Free skin, download without charge.',
    'skinDetail.purchase.loading': 'Processing...',
    'skinDetail.purchase.download': 'Download',
    'skinDetail.purchase.buy': 'Buy now',
    'skinDetail.purchase.openLink': 'Open download link',
    'skinDetail.preview.eyebrow': 'Preview',
    'skinDetail.preview.title': 'Screenshots',
    'skinDetail.preview.count': 'Showing {{count}} preview(s)',
    'skinDetail.preview.alt': 'Preview {{index}}',
    'skinDetail.preview.empty': 'No preview images yet.',
    'skinDetail.wiki.eyebrow': 'Wiki',
    'skinDetail.wiki.title': 'About this skin',
    'skinDetail.wiki.edit': 'Edit wiki',
    'skinDetail.wiki.empty': 'No wiki content yet.',
    'skinDetail.wiki.error': 'Unable to load wiki.',
    'skinDetail.comment.eyebrow': 'Comments',
    'skinDetail.comment.title': 'Discussion',
    'home.empty.news': 'No news or help posts yet.',
    'home.empty.arrival': 'No new arrivals yet.',
    'home.empty.weekly': 'Weekly picks will appear here soon.',
    'home.stats.pages.label': 'Pages',
    'home.stats.pages.desc': 'Wiki, songs, charts, guides',
    'home.stats.songs.label': 'Songs',
    'home.stats.songs.desc': 'Multi-mode song entries',
    'home.stats.players.label': 'Players',
    'home.stats.players.desc': 'Across PC, mobile and web',
    'wiki.eyebrow': 'Wiki',
    'wiki.subtitle': 'Client-side rendering for Malody Wiki syntax with language-aware fallbacks.',
    'wiki.langLabel': 'Content language',
    'wiki.langHint': 'Switch language to see available translations. Falls back to English when missing.',
    'wiki.hiddenLabel': 'Click to display',
    'wiki.templateLabel': 'Template',
    'wiki.template.loading': 'Loading template...',
    'wiki.template.error': 'Failed to load template content.',
    'wiki.template.login': 'Please sign in to view this block.',
    'wiki.template.finish': 'Finished',
    'wiki.template.empty': 'No entries yet.',
    'wiki.template.group': 'Group {{id}}',
    'wiki.template.eventsum': 'Event summary',
    'wiki.template.unsupported': 'Template coming soon.',
    'wiki.template.unknown': 'Unknown template.',
    'wiki.context.page': 'Standalone wiki',
    'wiki.context.song': 'Song wiki',
    'wiki.context.chart': 'Chart wiki',
    'wiki.context.user': 'Player wiki',
    'wiki.error.missingId': 'Missing wiki target (pid/sid/cid/touid).',
    'wiki.error.notFound': 'Wiki content not found.',
    'wiki.error.load': 'Unable to load wiki right now.',
    'wiki.error.save': 'Failed to save wiki.',
    'wiki.error.auth': 'Please sign in to edit.',
    'wiki.error.empty': 'Nothing here yet.',
    'wiki.title.page': 'Wiki page #{{id}}',
    'wiki.title.song': 'Song wiki #{{id}}',
    'wiki.title.chart': 'Chart wiki #{{id}}',
    'wiki.title.user': 'Player wiki #{{id}}',
    'wiki.title.fallback': 'Wiki',
    'wiki.lang.zh': '简体中文',
    'wiki.lang.en': 'English',
    'wiki.lang.ja': '日本語',
    'wiki.lang.ko': 'Korean',
    'wiki.lang.tc': 'Traditional Chinese',
    'wiki.templates.found': '{{count}} dynamic block(s)',
    'wiki.templates.none': 'Static content',
    'wiki.locked': 'Locked',
    'wiki.edit': 'Edit wiki',
    'wiki.editing': 'Editing',
    'wiki.edit.cancel': 'Cancel',
    'wiki.save': 'Save',
    'wiki.save.saving': 'Saving...',
    'wiki.save.success': 'Saved',
    'wiki.draft.placeholder': 'Edit wiki content with Malody syntax...',
    'wiki.preview': 'Preview',
    'wiki.testEntry.title': 'New wiki renderer preview',
    'wiki.testEntry.desc': 'Open the wiki demo page from Home > News to verify the parser.',
    'tag.news': 'News',
    'tag.update': 'Update',
    'tag.event': 'Event',
    'tag.guide': 'Guide',
    'tag.wiki': 'Wiki',
    'tag.new': 'New',
    'tag.weekly': 'Weekly Pick',
    'footer.links': 'External links',
    'footer.copy': 'Copyright © 2013 ~ 2025 Mugzone',
    'footer.language': 'Language',
    'footer.languageHint': 'Switch language',
    'footer.theme': 'Theme',
    'footer.themeHint': 'Switch theme',
    'theme.system': 'System',
    'theme.dark': 'Dark',
    'theme.light': 'Light',
    'language.en-US': 'English',
    'language.zh-CN': '简体中文',
    'language.ja': '日本語',
    'auth.tab.signIn': 'Sign in',
    'auth.tab.signUp': 'Sign up',
    'auth.field.username': 'Username or email',
    'auth.field.email': 'Email',
    'auth.field.password': 'Password',
    'auth.placeholder.username': 'Your username',
    'auth.placeholder.email': 'you@example.com',
    'auth.placeholder.password': 'Your password',
    'auth.error.login': 'Sign in failed, please check your account or password',
    'auth.error.register': 'Sign up failed, please try again later',
    'auth.error.-1': 'Invalid params or validation failed',
    'auth.error.-2': 'Too many attempts or username exists',
    'auth.error.-3': 'Email exists or account/password incorrect',
    'auth.error.-4': 'Account banned',
    'auth.error.-5': 'Device or IP banned / invalid email',
    'auth.error.-6': 'Password not valid (needs 32-char MD5)',
    'auth.error.-7': 'Device banned',
    'auth.error.md5': 'Password must be a 32-character MD5 string',
    'auth.submit.signIn': 'Sign in',
    'auth.submit.signUp': 'Create account',
    'auth.submit.loading': 'Please wait...',
    'auth.close': 'Close',
    'rank.eyebrow': 'Players',
    'rank.title': 'Global Leaderboard',
    'rank.desc':
      'Experience and MM rankings by mode. ',
    'rank.about.title': 'About',
    'rank.about.desc': 'Shows Top 200 players per mode for score rank and MM rank.',
    'rank.selectMode': 'Select mode',
    'rank.table.player': 'Player',
    'rank.table.score.mm': 'MM Score',
    'rank.table.score.exp': 'EXP',
    'rank.table.stats': 'Stats',
    'rank.table.empty': 'No data yet.',
    'rank.table.showing': 'Showing {{count}} players',
    'rank.table.loadMore': 'Load more',
    'rank.table.loading': 'Loading...',
    'rank.error.fetch': 'Unable to fetch leaderboard, please try again later',
    'rank.error.network': 'Unable to fetch leaderboard, please check your network and retry',
    'rank.meta.level': 'Lv. {{value}}',
    'rank.meta.play': 'Play {{value}}',
    'rank.meta.acc': 'Acc {{value}}',
    'rank.meta.combo': 'Combo {{value}}',
    'mode.key': 'Key',
    'mode.catch': 'Catch',
    'mode.taiko': 'Taiko',
    'mode.pad': 'Pad',
    'mode.ring': 'Ring',
    'mode.slide': 'Slide',
    'mode.live': 'Live',
    'mode.cube': 'Cube',
    'song.eyebrow': 'Song',
    'song.placeholder.title': 'Loading song...',
    'song.placeholder.artist': 'Loading artist...',
    'song.error.missingId': 'Missing song id',
    'song.error.load': 'Unable to load song info',
    'song.meta.id': 'Song #{{id}}',
    'song.charts.eyebrow': 'Charts',
    'song.charts.title': 'Charts for this song',
    'song.charts.creator': 'By {{name}}',
    'song.charts.creatorUnknown': 'Unknown creator',
    'song.charts.untitled': 'Untitled chart',
    'song.charts.loadError': 'Unable to load charts',
    'song.charts.empty': 'No charts yet.',
    'song.charts.type.official': 'Official',
    'song.charts.type.ugc': 'Community',
    'song.charts.type.beta': 'Beta',
    'song.charts.type.unknown': 'Type {{value}}',
    'song.wiki.eyebrow': 'Wiki',
    'song.wiki.title': 'Song wiki',
    'song.wiki.viewFull': 'Open full wiki',
    'song.wiki.empty': 'No wiki content yet.',
    'song.wiki.error': 'Unable to load wiki right now',
    'song.edit.eyebrow': 'Manage',
    'song.edit.title': 'Edit song info',
    'song.edit.desc':
      'Update title, artist, length, BPM, or cover. Only chart owners or org members can save changes.',
    'song.edit.login': 'Sign in with the uploader account to edit this song.',
    'song.edit.field.title': 'Title',
    'song.edit.field.artist': 'Artist',
    'song.edit.field.titleOrg': 'Original title (optional)',
    'song.edit.field.artistOrg': 'Original artist (optional)',
    'song.edit.field.length': 'Length (seconds)',
    'song.edit.field.bpm': 'BPM',
    'song.edit.lengthHint': 'Use seconds or mm:ss',
    'song.edit.save': 'Save changes',
    'song.edit.saving': 'Saving...',
    'song.edit.saved': 'Song info saved',
    'song.edit.open': 'Edit info',
    'song.edit.back': 'Back to song page',
    'song.edit.error.required': 'Title, artist, length, and BPM are required.',
    'song.edit.error.length': 'Length must be a positive number of seconds.',
    'song.edit.error.bpm': 'BPM must be a positive number.',
    'song.edit.error.permission': 'You do not have permission to edit this song.',
    'song.edit.error.duplicate': 'A song with the same title and artist already exists.',
    'song.edit.error.invalidChar': 'Title or artist has too many non-ASCII characters.',
    'song.edit.error.save': 'Unable to save song info, please try again.',
    'song.edit.cover.title': 'Cover',
    'song.edit.cover.hint': 'JPG/PNG only. Upload will replace the existing cover.',
    'song.edit.cover.select': 'Choose image',
    'song.edit.cover.upload': 'Upload cover',
    'song.edit.cover.uploading': 'Uploading...',
    'song.edit.cover.success': 'Cover uploaded. It may take a few seconds to refresh.',
    'song.edit.cover.error': 'Unable to upload cover right now.',
    'song.edit.cover.needFile': 'Please pick a JPG or PNG first.',
    'chart.eyebrow': 'Chart',
    'chart.placeholder.title': 'Loading chart...',
    'chart.placeholder.artist': 'Loading artist...',
    'chart.placeholder.version': 'Version loading...',
    'chart.placeholder.creator': 'Creator loading...',
    'chart.error.missingId': 'Missing chart id',
    'chart.error.load': 'Unable to load chart info',
    'chart.meta.song': 'Song #{{id}}',
    'chart.meta.level': 'Level {{level}}',
    'chart.meta.creator': 'Chart creator',
    'chart.score.title': 'User score',
    'chart.score.value': '{{value}} / 5',
    'chart.score.percent': '{{value}}% positive',
    'chart.score.like': 'Like',
    'chart.score.dislike': 'Dislike',
    'chart.tab.ranking': 'Ranking',
    'chart.tab.comment': 'Comments',
    'chart.tab.donate': 'Donate',
    'chart.tab.wiki': 'Wiki',
    'chart.ranking.error': 'Unable to load ranking',
    'chart.ranking.empty': 'No scores yet.',
    'chart.ranking.player': 'Player',
    'chart.ranking.score': 'Score',
    'chart.ranking.acc': 'Acc',
    'chart.ranking.combo': 'Combo',
    'chart.ranking.time': 'Time',
    'chart.ranking.unknown': 'Unknown',
    'chart.ranking.platform': 'Platform',
    'chart.ranking.platform.mobile': 'Mobile',
    'chart.ranking.platform.pc': 'PC',
    'chart.ranking.sort': 'Sort',
    'chart.ranking.sort.score': 'Score',
    'chart.ranking.sort.combo': 'Combo',
    'chart.ranking.sort.acc': 'Accuracy',
    'chart.ranking.modFilter': 'Filter',
    'chart.ranking.mod.all': 'All scores',
    'chart.ranking.noMod': 'No MOD',
    'chart.ranking.noSpeed': 'No speed MOD',
    'chart.ranking.noModNoSpeed': 'No MOD + no speed',
    'chart.donate.send': 'Send',
    'chart.donate.sending': 'Sending...',
    'chart.donate.empty': 'No donations yet.',
    'chart.donate.error': 'Unable to submit donation',
    'chart.donate.invalid': 'Please enter a valid amount',
    'chart.donate.unknown': 'Anonymous',
    'chart.donate.gold': '{{value}} Gold',
    'chart.wiki.error': 'Unable to load wiki',
    'chart.wiki.empty': 'No wiki content yet.',
    'player.eyebrow': 'Player',
    'player.placeholder.name': 'Loading player...',
    'player.error.missingId': 'Missing player id',
    'player.error.info': 'Unable to load player info',
    'player.error.activity': 'Unable to load activity',
    'player.error.charts': 'Unable to load charts',
    'player.error.rank': 'Unable to load ranking',
    'player.wikiLink': 'Open wiki',
    'player.joined': 'Joined {{time}}',
    'player.loading': 'Loading player...',
    'player.stat.level': 'Level',
    'player.stat.playcount': 'Playcount',
    'player.stat.acc': 'Accuracy',
    'player.stat.combo': 'Max combo',
    'player.stat.mmr': 'MMR',
    'player.meta.gold': 'Gold {{value}}',
    'player.meta.exp': 'EXP {{value}}',
    'player.meta.playcount': '{{value}} plays',
    'player.section.activity': 'Activity',
    'player.section.activityTitle': 'Recent activity',
    'player.activity.empty': 'No activity yet.',
    'player.activity.unknown': 'No description',
    'player.activity.link': 'View',
    'player.section.charts': 'Charts',
    'player.section.chartsTitle': 'Created charts',
    'player.charts.empty': 'No charts from this player.',
    'player.charts.untitled': 'Untitled chart',
    'player.charts.unknown': 'Unknown artist',
    'player.section.rank': 'Ranking',
    'player.section.rankTitle': 'Performance',
    'player.rank.empty': 'No ranking data.',
    'player.rank.position': 'Rank {{value}}',
    'player.rank.unknown': 'Unknown',
    'player.section.wiki': 'Wiki',
    'player.section.wikiTitle': 'Player wiki',
    'player.tab.activity': 'Activity',
    'player.tab.charts': 'Charts',
    'player.tab.rank': 'Ranking',
    'player.tab.wiki': 'Wiki',
    'player.wiki.desc': 'Open the player wiki to view profile, bio, and edits.',
    'player.wiki.error': 'Unable to load player wiki',
    'player.wiki.empty': 'No wiki content for this player yet.',
    'comment.label': 'Comments',
    'comment.placeholder': 'Share your thoughts...',
    'comment.submit': 'Post',
    'comment.submitting': 'Posting...',
    'comment.loading': 'Loading...',
    'comment.loadMore': 'Load more',
    'comment.empty': 'No comments yet.',
    'comment.error.fetch': 'Unable to load comments',
    'comment.error.post': 'Failed to post comment',
    'comment.error.delete': 'Failed to delete comment',
    'comment.error.auth': 'Please sign in to comment',
    'comment.error.empty': 'Comment cannot be empty',
    'comment.user.unknown': 'Guest',
    'comment.currentUser': 'UID {{uid}}',
    'comment.delete': 'Delete',
    'comment.deleting': 'Deleting...',
  },
  'zh-CN': {
    'nav.home': '首页',
    'nav.charts': '谱面',
    'nav.skins': '皮肤',
    'nav.wiki': 'Wiki',
    'nav.events': '赛事',
    'nav.players': '玩家',
    'nav.talk': '讨论',
    'topbar.signIn': '登录',
    'topbar.signUp': '注册',
    'topbar.signOut': '退出',
    'topbar.hi': '你好，{{name}}',
    'banner.featured': '精选',
    'home.hero.title': 'Malody 社区',
    'home.hero.desc':
      'Malody是由一群热爱音乐的人开发的多平台音乐游戏，谱面来自玩家自制，现在加入社区开始你的探索之旅。',
    'home.hero.communityEyebrow': '社区',
    'home.hero.cardTitle': '每周精选与新到谱面',
    'home.hero.cardDesc': '每周更新策划推荐。提交你的作品登上榜单。',
    'home.hero.chip.multi': '多玩法',
    'home.hero.chip.cross': '全平台',
    'home.hero.chip.creator': '创作者友好',
    'home.hero.cta.primary': '下载 Malody V',
    'home.hero.cta.secondary': '了解更多',
    'home.section.news': '新闻与帮助',
    'home.section.newArrival': '新到谱面',
    'home.section.weeklyShow': '每周精选',
    'home.section.more': '更多 →',
    'charts.eyebrow': '谱面',
    'charts.title': '浏览全部谱面',
    'charts.desc': '按玩法、等级、Freestyle 或关键词筛选。',
    'charts.filter.title': '筛选',
    'charts.filter.keyword': '关键词',
    'charts.filter.keywordPlaceholder': '歌曲、作者、标签...',
    'charts.filter.mode': '玩法',
    'charts.filter.level': '等级范围',
    'charts.filter.levelMin': '最低等级',
    'charts.filter.levelMax': '最高等级',
    'charts.filter.free': '仅显示 Freestyle',
    'charts.filter.beta': '包含 beta 谱面',
    'charts.filter.apply': '应用筛选',
    'charts.filter.reset': '重置',
    'charts.mode.all': '全部玩法',
    'charts.listTitle': '谱面列表',
    'charts.results.count': '已显示 {{count}} 首',
    'charts.results.empty': '没有符合筛选的谱面',
    'charts.error.fetch': '暂时无法获取谱面',
    'charts.error.network': '网络错误，请稍后重试',
    'charts.loading': '加载中...',
    'charts.loadMore': '加载更多',
    'charts.card.length': '时长 {{value}}',
    'charts.card.lengthUnknown': '时长 —',
    'charts.card.bpm': '{{value}} BPM',
    'charts.card.bpmUnknown': 'BPM —',
    'charts.card.updated': '更新于 {{time}}',
    'charts.card.updatedUnknown': '更新于 —',
    'charts.card.view': '查看详情',
    'charts.badge.freestyle': 'Freestyle',
    'charts.badge.beta': 'Beta',
    'events.eyebrow': '赛事',
    'events.title': '社区赛事',
    'events.desc': '加入正在进行的活动或回顾往期挑战。',
    'events.filter.activeOnly': '仅显示进行中的赛事',
    'events.highlight.title': '赛事说明',
    'events.highlight.desc': '赛事包含策划推荐的谱面和专属规则，快来参与。',
    'events.listTitle': '赛事列表',
    'events.results.count': '共 {{count}} 个赛事',
    'events.results.empty': '暂无赛事',
    'events.error.fetch': '暂时无法获取赛事',
    'events.error.network': '网络错误，请稍后再试',
    'events.loading': '加载中...',
    'events.loadMore': '加载更多',
    'events.status.upcoming': '即将开始',
    'events.status.ongoing': '进行中',
    'events.status.ended': '已结束',
    'events.status.unknown': '待定',
    'events.time.unknown': '待定',
    'events.name.untitled': '未命名赛事',
    'skins.eyebrow': '皮肤',
    'skins.title': '探索皮肤',
    'skins.desc': '按玩法与关键词查找皮肤。',
    'skins.filter.title': '筛选',
    'skins.filter.keyword': '关键词',
    'skins.filter.keywordPlaceholder': '皮肤名称...',
    'skins.filter.mode': '玩法',
    'skins.filter.apply': '应用筛选',
    'skins.filter.reset': '重置',
    'skins.mode.all': '全部玩法',
    'skins.listTitle': '皮肤列表',
    'skins.results.count': '已显示 {{count}} 个皮肤',
    'skins.results.empty': '没有符合筛选的皮肤',
    'skins.error.fetch': '暂时无法获取皮肤',
    'skins.error.network': '网络错误，请稍后再试',
    'skins.loading': '加载中...',
    'skins.loadMore': '加载更多',
    'skins.price.value': '{{value}} 金币',
    'skins.price.free': '免费',
    'skins.sales': '{{value}} 次购买',
    'skins.creator': '作者 {{name}}',
    'skins.creator.unknown': '作者未知',
    'skins.badge.owned': '已拥有',
    'skinDetail.eyebrow': '皮肤',
    'skinDetail.placeholder.name': '正在加载皮肤...',
    'skinDetail.creator': '作者 {{name}}',
    'skinDetail.creator.unknown': '作者未知',
    'skinDetail.sales': '{{value}} 次购买',
    'skinDetail.updated': '更新于 {{time}}',
    'skinDetail.meta.id': '皮肤 #{{id}}',
    'skinDetail.error.missingId': '缺少皮肤 ID',
    'skinDetail.error.notFound': '未找到皮肤',
    'skinDetail.error.load': '暂时无法获取皮肤信息',
    'skinDetail.error.auth': '请登录后继续操作',
    'skinDetail.error.insufficient': '金币不足，无法购买此皮肤',
    'skinDetail.error.buy': '购买失败，请稍后重试',
    'skinDetail.purchase.title': '购买 / 下载',
    'skinDetail.purchase.desc': '使用金币购买后即可永久下载此皮肤。',
    'skinDetail.purchase.freeDesc': '免费皮肤，可直接下载。',
    'skinDetail.purchase.loading': '处理中...',
    'skinDetail.purchase.download': '下载',
    'skinDetail.purchase.buy': '立即购买',
    'skinDetail.purchase.openLink': '打开下载链接',
    'skinDetail.preview.eyebrow': '预览',
    'skinDetail.preview.title': '预览图',
    'skinDetail.preview.count': '共 {{count}} 张',
    'skinDetail.preview.alt': '预览图 {{index}}',
    'skinDetail.preview.empty': '暂无预览图',
    'skinDetail.wiki.eyebrow': 'Wiki',
    'skinDetail.wiki.title': '皮肤说明',
    'skinDetail.wiki.edit': '编辑 Wiki',
    'skinDetail.wiki.empty': '还没有 Wiki 内容',
    'skinDetail.wiki.error': '加载 Wiki 失败',
    'skinDetail.comment.eyebrow': '评论',
    'skinDetail.comment.title': '讨论',
    'home.empty.news': '暂无新闻或帮助内容',
    'home.empty.arrival': '暂无新到谱面',
    'home.empty.weekly': '每周精选暂未发布',
    'home.stats.pages.label': '页面',
    'home.stats.pages.desc': 'Wiki、歌曲、谱面、指南',
    'home.stats.songs.label': '歌曲',
    'home.stats.songs.desc': '多玩法歌曲条目',
    'home.stats.players.label': '玩家',
    'home.stats.players.desc': '覆盖 PC、移动端与 Web',
    'wiki.eyebrow': 'Wiki',
    'wiki.subtitle': '前端解析 Malody Wiki 语法，支持多语言切换。',
    'wiki.langLabel': '内容语言',
    'wiki.langHint': '切换语言查看对应翻译，未提供时会回退英文。',
    'wiki.hiddenLabel': '点击展开',
    'wiki.templateLabel': '模板',
    'wiki.template.loading': '模板数据加载中...',
    'wiki.template.error': '模板加载失败。',
    'wiki.template.login': '请登录后查看此内容。',
    'wiki.template.finish': '已完成',
    'wiki.template.empty': '暂无数据。',
    'wiki.template.group': '用户组 {{id}}',
    'wiki.template.eventsum': '活动汇总',
    'wiki.template.unsupported': '模板待实现。',
    'wiki.template.unknown': '未知模板。',
    'wiki.context.page': '独立页面',
    'wiki.context.song': '歌曲 Wiki',
    'wiki.context.chart': '谱面 Wiki',
    'wiki.context.user': '个人主页 Wiki',
    'wiki.error.missingId': '缺少 wiki 目标（pid/sid/cid/touid）。',
    'wiki.error.notFound': '未找到 Wiki 内容。',
    'wiki.error.load': '暂时无法加载 Wiki。',
    'wiki.error.save': '保存失败，请稍后重试。',
    'wiki.error.auth': '请先登录后再编辑。',
    'wiki.error.empty': '这里还没有内容。',
    'wiki.title.page': 'Wiki 页面 #{{id}}',
    'wiki.title.song': '歌曲 Wiki #{{id}}',
    'wiki.title.chart': '谱面 Wiki #{{id}}',
    'wiki.title.user': '玩家 Wiki #{{id}}',
    'wiki.title.fallback': 'Wiki',
    'wiki.lang.zh': '简体中文',
    'wiki.lang.en': 'English',
    'wiki.lang.ja': '日本語',
    'wiki.lang.ko': 'Korean',
    'wiki.lang.tc': '繁體中文',
    'wiki.templates.found': '{{count}} 个动态片段',
    'wiki.templates.none': '静态内容',
    'wiki.locked': '已锁定',
    'wiki.edit': '编辑 Wiki',
    'wiki.editing': '编辑中',
    'wiki.edit.cancel': '取消',
    'wiki.save': '保存',
    'wiki.save.saving': '保存中...',
    'wiki.save.success': '已保存',
    'wiki.draft.placeholder': '使用 Malody 语法编辑 Wiki 内容...',
    'wiki.preview': '预览',
    'wiki.testEntry.title': 'Wiki 渲染器预览',
    'wiki.testEntry.desc': '从首页进入 wiki 页面，体验前端解析效果。',
    'tag.news': '新闻',
    'tag.update': '更新',
    'tag.event': '活动',
    'tag.guide': '指南',
    'tag.wiki': 'Wiki',
    'tag.new': '最新',
    'tag.weekly': '每周精选',
    'footer.links': '外部链接',
    'footer.copy': 'Copyright © 2013 ~ 2025 Mugzone',
    'footer.language': '语言',
    'footer.languageHint': '手动切换语言',
    'footer.theme': '主题',
    'footer.themeHint': '切换主题',
    'theme.system': '跟随系统',
    'theme.dark': '深色',
    'theme.light': '浅色',
    'language.en-US': 'English',
    'language.zh-CN': '简体中文',
    'language.ja': '日本語',
    'auth.tab.signIn': '登录',
    'auth.tab.signUp': '注册',
    'auth.field.username': '用户名或邮箱',
    'auth.field.email': '邮箱',
    'auth.field.password': '密码',
    'auth.placeholder.username': '输入用户名',
    'auth.placeholder.email': 'you@example.com',
    'auth.placeholder.password': '输入密码',
    'auth.error.login': '登录失败，请检查账号或密码',
    'auth.error.register': '注册失败，请稍后再试',
    'auth.error.-1': '参数错误或校验失败',
    'auth.error.-2': '尝试次数过多或用户名已存在',
    'auth.error.-3': '邮箱已存在或账号密码错误',
    'auth.error.-4': '账号被封禁',
    'auth.error.-5': '设备或 IP 被封禁 / 邮箱不合法',
    'auth.error.-6': '密码不合法（需要32位MD5）',
    'auth.error.-7': '设备被封禁',
    'auth.error.md5': '密码需要生成 32 位 MD5',
    'auth.submit.signIn': '登录',
    'auth.submit.signUp': '创建账户',
    'auth.submit.loading': '请稍等...',
    'auth.close': '关闭',
    'rank.eyebrow': '玩家',
    'rank.title': '全球排行榜',
    'rank.desc': '按玩法查看 EXP 与 MM 榜单。',
    'rank.about.title': '说明',
    'rank.about.desc': '展示各个模式下 Top200 玩家 的分数排名和 MM 排名。',
    'rank.selectMode': '选择玩法',
    'rank.table.player': '玩家',
    'rank.table.score.mm': 'MM 分',
    'rank.table.score.exp': 'EXP',
    'rank.table.stats': '数据',
    'rank.table.empty': '暂无数据',
    'rank.table.showing': '已显示 {{count}} 位玩家',
    'rank.table.loadMore': '加载更多',
    'rank.table.loading': '加载中...',
    'rank.error.fetch': '无法获取排行榜，请稍后重试',
    'rank.error.network': '无法获取排行榜，请检查网络后重试',
    'rank.meta.level': '等级 {{value}}',
    'rank.meta.play': '游玩 {{value}}',
    'rank.meta.acc': '准确率 {{value}}',
    'rank.meta.combo': '连击 {{value}}',
    'mode.key': 'Key',
    'mode.catch': 'Catch',
    'mode.taiko': '太鼓',
    'mode.pad': 'Pad',
    'mode.ring': 'Ring',
    'mode.slide': 'Slide',
    'mode.live': 'Live',
    'mode.cube': 'Cube',
    'song.eyebrow': '歌曲',
    'song.placeholder.title': '加载中...',
    'song.placeholder.artist': '演唱者加载中...',
    'song.error.missingId': '缺少歌曲 ID',
    'song.error.load': '无法获取歌曲信息',
    'song.meta.id': '歌曲 #{{id}}',
    'song.charts.eyebrow': '谱面',
    'song.charts.title': '该歌曲的谱面列表',
    'song.charts.creator': '{{name}} 制作',
    'song.charts.creatorUnknown': '未知制谱者',
    'song.charts.untitled': '未命名谱面',
    'song.charts.loadError': '无法加载谱面',
    'song.charts.empty': '暂无谱面',
    'song.charts.type.official': '官方',
    'song.charts.type.ugc': '社区',
    'song.charts.type.beta': '测试',
    'song.charts.type.unknown': '类型 {{value}}',
    'song.wiki.eyebrow': 'Wiki',
    'song.wiki.title': '歌曲 Wiki',
    'song.wiki.viewFull': '查看完整 Wiki',
    'song.wiki.empty': '暂无 Wiki 内容',
    'song.wiki.error': '无法加载 Wiki',
    'song.edit.eyebrow': '信息维护',
    'song.edit.title': '编辑歌曲信息',
    'song.edit.desc': '修改标题、作者、时长、BPM 或封面，仅限该曲谱作者或官方账号。',
    'song.edit.login': '需要登录对应账号才能编辑歌曲。',
    'song.edit.field.title': '标题',
    'song.edit.field.artist': '艺术家',
    'song.edit.field.titleOrg': '原始标题（选填）',
    'song.edit.field.artistOrg': '原始艺术家（选填）',
    'song.edit.field.length': '时长（秒）',
    'song.edit.field.bpm': 'BPM',
    'song.edit.lengthHint': '支持秒数或 mm:ss',
    'song.edit.save': '保存修改',
    'song.edit.saving': '保存中...',
    'song.edit.saved': '已保存歌曲信息',
    'song.edit.open': '编辑信息',
    'song.edit.back': '返回歌曲页',
    'song.edit.error.required': '请填写标题、艺术家、时长和 BPM。',
    'song.edit.error.length': '时长必须是大于 0 的秒数。',
    'song.edit.error.bpm': 'BPM 需要是大于 0 的数字。',
    'song.edit.error.permission': '你没有权限编辑这首歌。',
    'song.edit.error.duplicate': '已存在同名歌曲。',
    'song.edit.error.invalidChar': '标题或艺术家包含过多特殊字符。',
    'song.edit.error.save': '保存失败，请稍后再试。',
    'song.edit.cover.title': '封面',
    'song.edit.cover.hint': '仅支持 JPG/PNG，上传会覆盖原有封面。',
    'song.edit.cover.select': '选择图片',
    'song.edit.cover.upload': '上传封面',
    'song.edit.cover.uploading': '正在上传...',
    'song.edit.cover.success': '封面上传成功，刷新可能需要几秒钟。',
    'song.edit.cover.error': '暂时无法上传封面。',
    'song.edit.cover.needFile': '请先选择一张 JPG/PNG 图片。',
    'chart.eyebrow': '谱面',
    'chart.placeholder.title': '加载谱面信息...',
    'chart.placeholder.artist': '演唱者加载中...',
    'chart.placeholder.version': '版本加载中...',
    'chart.placeholder.creator': '制谱者加载中...',
    'chart.error.missingId': '缺少谱面 ID',
    'chart.error.load': '无法获取谱面信息',
    'chart.meta.song': '歌曲 #{{id}}',
    'chart.meta.level': '等级 {{level}}',
    'chart.meta.creator': '制谱者',
    'chart.score.title': '用户评分',
    'chart.score.value': '{{value}} / 5',
    'chart.score.percent': '{{value}}% 好评',
    'chart.score.like': '点赞',
    'chart.score.dislike': '点踩',
    'chart.tab.ranking': '排行',
    'chart.tab.comment': '评论',
    'chart.tab.donate': '打赏',
    'chart.tab.wiki': 'Wiki',
    'chart.ranking.error': '无法加载排行榜',
    'chart.ranking.empty': '暂无成绩',
    'chart.ranking.player': '玩家',
    'chart.ranking.score': '分数',
    'chart.ranking.acc': '准确率',
    'chart.ranking.combo': '连击',
    'chart.ranking.time': '时间',
    'chart.ranking.unknown': '未知',
    'chart.ranking.platform': '平台',
    'chart.ranking.platform.mobile': '移动端',
    'chart.ranking.platform.pc': 'PC 端',
    'chart.ranking.sort': '排序',
    'chart.ranking.sort.score': '按分数',
    'chart.ranking.sort.combo': '按连击',
    'chart.ranking.sort.acc': '按准确率',
    'chart.ranking.modFilter': '筛选',
    'chart.ranking.mod.all': '全部成绩',
    'chart.ranking.noMod': '无 MOD',
    'chart.ranking.noSpeed': '无变速',
    'chart.ranking.noModNoSpeed': '无 MOD 且无变速',
    'chart.donate.send': '打赏',
    'chart.donate.sending': '打赏中...',
    'chart.donate.empty': '还没有人打赏',
    'chart.donate.error': '打赏失败',
    'chart.donate.invalid': '请输入正确的数值',
    'chart.donate.unknown': '匿名',
    'chart.donate.gold': '{{value}} 金币',
    'chart.wiki.error': '无法加载 Wiki',
    'chart.wiki.empty': '暂无 Wiki 内容',
    'player.eyebrow': '玩家',
    'player.placeholder.name': '加载玩家信息...',
    'player.error.missingId': '缺少用户 ID',
    'player.error.info': '无法获取玩家信息',
    'player.error.activity': '无法获取动态',
    'player.error.charts': '无法获取谱面列表',
    'player.error.rank': '无法获取排名',
    'player.wikiLink': '查看 Wiki',
    'player.joined': '注册于 {{time}}',
    'player.loading': '正在加载玩家信息...',
    'player.stat.level': '等级',
    'player.stat.playcount': '游玩次数',
    'player.stat.acc': '准确率',
    'player.stat.combo': '最高连击',
    'player.stat.mmr': 'MMR',
    'player.meta.gold': '金币 {{value}}',
    'player.meta.exp': '经验 {{value}}',
    'player.meta.playcount': '{{value}} 次游玩',
    'player.section.activity': '动态',
    'player.section.activityTitle': '最近动态',
    'player.activity.empty': '还没有动态',
    'player.activity.unknown': '暂无描述',
    'player.activity.link': '查看',
    'player.section.charts': '谱面',
    'player.section.chartsTitle': 'TA 的谱面',
    'player.charts.empty': '暂无该玩家的谱面',
    'player.charts.untitled': '未命名谱面',
    'player.charts.unknown': '未知作者',
    'player.section.rank': '排行',
    'player.section.rankTitle': '表现',
    'player.rank.empty': '暂无排行数据',
    'player.rank.position': '排名 {{value}}',
    'player.rank.unknown': '未知',
    'player.section.wiki': 'Wiki',
    'player.section.wikiTitle': '玩家 Wiki',
    'player.tab.activity': '动态',
    'player.tab.charts': '谱面',
    'player.tab.rank': '排行',
    'player.tab.wiki': 'Wiki',
    'player.wiki.desc': '打开玩家 Wiki 查看个人简介与编辑记录。',
    'player.wiki.error': '无法加载玩家 Wiki',
    'player.wiki.empty': '暂无该玩家的 Wiki 内容。',
    'comment.label': '评论',
    'comment.placeholder': '发表你的想法...',
    'comment.submit': '发表评论',
    'comment.submitting': '提交中...',
    'comment.loading': '加载中...',
    'comment.loadMore': '加载更多',
    'comment.empty': '还没有评论',
    'comment.error.fetch': '无法获取评论',
    'comment.error.post': '提交失败',
    'comment.error.delete': '删除失败',
    'comment.error.auth': '请先登录后再评论',
    'comment.error.empty': '内容不能为空',
    'comment.user.unknown': '访客',
    'comment.currentUser': 'UID {{uid}}',
    'comment.delete': '删除',
    'comment.deleting': '删除中...',
  },
  ja: {
    'nav.home': 'ホーム',
    'nav.charts': '譜面',
    'nav.skins': 'スキン',
    'nav.wiki': 'Wiki',
    'nav.events': 'イベント',
    'nav.players': 'プレイヤー',
    'nav.talk': 'トーク',
    'topbar.signIn': 'ログイン',
    'topbar.signUp': '新規登録',
    'topbar.signOut': 'ログアウト',
    'topbar.hi': 'こんにちは、{{name}}',
    'banner.featured': 'ピックアップ',
    'home.hero.title': 'Malody コミュニティ',
    'home.hero.desc':
      'Malody は有志のグループによって開発されているクロスプラットフォームの音楽ゲームです。譜面はすべて世界中のプレイヤーによって制作されています。私たちのコミュニティに参加して新たな道を歩みましょう！',
    'home.hero.communityEyebrow': 'コミュニティ',
    'home.hero.cardTitle': '毎週のおすすめと新着',
    'home.hero.cardDesc': '毎週キュレーションした譜面を紹介。あなたの作品でランキングを狙おう。',
    'home.hero.chip.multi': 'マルチモード',
    'home.hero.chip.cross': 'クロスプラットフォーム',
    'home.hero.chip.creator': 'クリエイターに優しい',
    'home.hero.cta.primary': 'Malody V を入手',
    'home.hero.cta.secondary': '詳しく見る',
    'home.section.news': 'ニュースとヘルプ',
    'home.section.newArrival': '新着',
    'home.section.weeklyShow': '毎週のピックアップ',
    'home.section.more': 'もっと見る →',
    'charts.eyebrow': '譜面',
    'charts.title': 'すべての譜面を閲覧',
    'charts.desc': 'モード、レベル、フリースタイル、キーワードで絞り込みできます。',
    'charts.filter.title': 'フィルター',
    'charts.filter.keyword': 'キーワード',
    'charts.filter.keywordPlaceholder': '曲名、作者、タグ...',
    'charts.filter.mode': 'モード',
    'charts.filter.level': 'レベル範囲',
    'charts.filter.levelMin': '最小レベル',
    'charts.filter.levelMax': '最大レベル',
    'charts.filter.free': 'フリースタイルのみ',
    'charts.filter.beta': 'ベータ譜面を含める',
    'charts.filter.apply': '適用',
    'charts.filter.reset': 'リセット',
    'charts.mode.all': 'すべてのモード',
    'charts.listTitle': '譜面一覧',
    'charts.results.count': '{{count}} 曲を表示中',
    'charts.results.empty': '条件に合う譜面がありません',
    'charts.error.fetch': '譜面を取得できません',
    'charts.error.network': 'ネットワークエラーです。再試行してください',
    'charts.loading': '読み込み中...',
    'charts.loadMore': 'さらに読み込む',
    'charts.card.length': '長さ {{value}}',
    'charts.card.lengthUnknown': '長さ —',
    'charts.card.bpm': '{{value}} BPM',
    'charts.card.bpmUnknown': 'BPM —',
    'charts.card.updated': '{{time}} に更新',
    'charts.card.updatedUnknown': '更新日 —',
    'charts.card.view': '詳細を見る',
    'charts.badge.freestyle': 'フリースタイル',
    'charts.badge.beta': 'ベータ',
    'events.eyebrow': 'イベント',
    'events.title': 'コミュニティイベント',
    'events.desc': '開催中のイベントに参加したり、過去の挑戦を振り返ろう。',
    'events.filter.activeOnly': '開催中のみ表示',
    'events.highlight.title': 'イベント概要',
    'events.highlight.desc': 'イベントではキュレーションされた譜面と独自ルールを用意。ぜひ参加してください。',
    'events.listTitle': 'イベント一覧',
    'events.results.count': '{{count}} 件を表示中',
    'events.results.empty': 'イベントがありません',
    'events.error.fetch': 'イベントを取得できません',
    'events.error.network': 'ネットワークエラーです。再試行してください',
    'events.loading': '読み込み中...',
    'events.loadMore': 'さらに読み込む',
    'events.status.upcoming': 'まもなく開始',
    'events.status.ongoing': '開催中',
    'events.status.ended': '終了',
    'events.status.unknown': '予定',
    'events.time.unknown': '未定',
    'events.name.untitled': 'イベント名未定',
    'skins.eyebrow': 'スキン',
    'skins.title': 'スキンを探す',
    'skins.desc': 'モードやキーワードでスキンを検索。',
    'skins.filter.title': 'フィルター',
    'skins.filter.keyword': 'キーワード',
    'skins.filter.keywordPlaceholder': 'スキン名...',
    'skins.filter.mode': 'モード',
    'skins.filter.apply': '適用',
    'skins.filter.reset': 'リセット',
    'skins.mode.all': 'すべてのモード',
    'skins.listTitle': 'スキン一覧',
    'skins.results.count': '{{count}} 件を表示中',
    'skins.results.empty': '条件に合うスキンがありません',
    'skins.error.fetch': 'スキンを取得できません',
    'skins.error.network': 'ネットワークエラーです。再試行してください',
    'skins.loading': '読み込み中...',
    'skins.loadMore': 'さらに読み込む',
    'skins.price.value': '{{value}} ゴールド',
    'skins.price.free': '無料',
    'skins.sales': '{{value}} 回購入',
    'skins.creator': '作者 {{name}}',
    'skins.creator.unknown': '作者不明',
    'skins.badge.owned': '所持済み',
    'skinDetail.eyebrow': 'スキン',
    'skinDetail.placeholder.name': 'スキンを読み込み中...',
    'skinDetail.creator': '{{name}} 作',
    'skinDetail.creator.unknown': '作者不明',
    'skinDetail.sales': '{{value}} 件の購入',
    'skinDetail.updated': '{{time}} に更新',
    'skinDetail.meta.id': 'スキン #{{id}}',
    'skinDetail.error.missingId': 'スキンIDがありません',
    'skinDetail.error.notFound': 'スキンが見つかりません',
    'skinDetail.error.load': 'スキンを取得できませんでした',
    'skinDetail.error.auth': '続行するにはログインしてください',
    'skinDetail.error.insufficient': 'ゴールドが足りないため購入できません',
    'skinDetail.error.buy': '購入に失敗しました。再試行してください',
    'skinDetail.purchase.title': '購入 / ダウンロード',
    'skinDetail.purchase.desc': 'ゴールドでこのスキンを購入します。',
    'skinDetail.purchase.freeDesc': '無料スキンはそのままダウンロードできます。',
    'skinDetail.purchase.loading': '処理中...',
    'skinDetail.purchase.download': 'ダウンロード',
    'skinDetail.purchase.buy': '購入する',
    'skinDetail.purchase.openLink': 'ダウンロードを開く',
    'skinDetail.preview.eyebrow': 'プレビュー',
    'skinDetail.preview.title': 'スクリーンショット',
    'skinDetail.preview.count': '{{count}} 枚を表示中',
    'skinDetail.preview.alt': 'プレビュー {{index}}',
    'skinDetail.preview.empty': 'プレビュー画像はまだありません。',
    'skinDetail.wiki.eyebrow': 'Wiki',
    'skinDetail.wiki.title': 'スキンの説明',
    'skinDetail.wiki.edit': 'Wiki を編集',
    'skinDetail.wiki.empty': 'Wiki がまだありません。',
    'skinDetail.wiki.error': 'Wiki を読み込めませんでした。',
    'skinDetail.comment.eyebrow': 'コメント',
    'skinDetail.comment.title': 'ディスカッション',
    'home.empty.news': 'ニュースやヘルプはまだありません',
    'home.empty.arrival': '新着譜面はまだありません',
    'home.empty.weekly': '毎週のおすすめは準備中です',
    'home.stats.pages.label': 'ページ',
    'home.stats.pages.desc': 'Wiki・楽曲・譜面・ガイド',
    'home.stats.songs.label': '楽曲',
    'home.stats.songs.desc': '複数モードの楽曲エントリー',
    'home.stats.players.label': 'プレイヤー',
    'home.stats.players.desc': 'PC・モバイル・Web に対応',
    'wiki.eyebrow': 'Wiki',
    'wiki.subtitle': 'フロントエンドで Malody Wiki の構文を解析し、多言語に対応します。',
    'wiki.langLabel': '表示言語',
    'wiki.langHint': '翻訳がない場合は英語にフォールバックします。',
    'wiki.hiddenLabel': 'クリックで表示',
    'wiki.templateLabel': 'テンプレート',
    'wiki.template.loading': 'テンプレートを読み込み中...',
    'wiki.template.error': 'テンプレートの読み込みに失敗しました。',
    'wiki.template.login': 'ログイン後に表示できます。',
    'wiki.template.finish': 'クリア済み',
    'wiki.template.empty': 'データがありません。',
    'wiki.template.group': 'グループ {{id}}',
    'wiki.template.eventsum': 'イベント集計',
    'wiki.template.unsupported': 'テンプレートは近日対応します。',
    'wiki.template.unknown': '不明なテンプレートです。',
    'wiki.context.page': '単独ページ',
    'wiki.context.song': '楽曲 Wiki',
    'wiki.context.chart': '譜面 Wiki',
    'wiki.context.user': 'プロフィール Wiki',
    'wiki.error.missingId': 'Wiki ターゲット (pid/sid/cid/touid) が不足しています。',
    'wiki.error.notFound': 'Wiki コンテンツが見つかりません。',
    'wiki.error.load': 'Wiki を読み込めません。',
    'wiki.error.save': 'Wiki の保存に失敗しました。',
    'wiki.error.auth': '編集するにはログインしてください。',
    'wiki.error.empty': 'まだコンテンツがありません。',
    'wiki.title.page': 'Wiki ページ #{{id}}',
    'wiki.title.song': '楽曲 Wiki #{{id}}',
    'wiki.title.chart': '譜面 Wiki #{{id}}',
    'wiki.title.user': 'プレイヤー Wiki #{{id}}',
    'wiki.title.fallback': 'Wiki',
    'wiki.lang.zh': '简体中文',
    'wiki.lang.en': 'English',
    'wiki.lang.ja': '日本語',
    'wiki.lang.ko': 'Korean',
    'wiki.lang.tc': '繁體中文',
    'wiki.templates.found': '動的ブロック {{count}} 件',
    'wiki.templates.none': '静的コンテンツ',
    'wiki.locked': 'ロック済み',
    'wiki.edit': 'Wiki を編集',
    'wiki.editing': '編集中',
    'wiki.edit.cancel': 'キャンセル',
    'wiki.save': '保存',
    'wiki.save.saving': '保存中...',
    'wiki.save.success': '保存しました',
    'wiki.draft.placeholder': 'Malody 構文で Wiki を編集してください...',
    'wiki.preview': 'プレビュー',
    'wiki.testEntry.title': 'Wiki レンダラーのプレビュー',
    'wiki.testEntry.desc': 'ホームのニュースから Wiki ページを開いて確認してください。',
    'tag.news': 'ニュース',
    'tag.update': 'アップデート',
    'tag.event': 'イベント',
    'tag.guide': 'ガイド',
    'tag.wiki': 'Wiki',
    'tag.new': '新着',
    'tag.weekly': '毎週のおすすめ',
    'footer.links': '外部リンク',
    'footer.copy': 'Copyright © 2013 ~ 2025 Mugzone',
    'footer.language': '言語',
    'footer.languageHint': '言語を変更',
    'footer.theme': 'テーマ',
    'footer.themeHint': 'テーマを変更',
    'theme.system': 'システム',
    'theme.dark': 'ダーク',
    'theme.light': 'ライト',
    'language.en-US': 'English',
    'language.zh-CN': '简体中文',
    'language.ja': '日本語',
    'auth.tab.signIn': 'ログイン',
    'auth.tab.signUp': '登録',
    'auth.field.username': 'ユーザー名またはメール',
    'auth.field.email': 'メール',
    'auth.field.password': 'パスワード',
    'auth.placeholder.username': 'ユーザー名を入力',
    'auth.placeholder.email': 'you@example.com',
    'auth.placeholder.password': 'パスワードを入力',
    'auth.error.login': 'ログインに失敗しました。アカウントかパスワードを確認してください',
    'auth.error.register': '登録に失敗しました。時間をおいて再試行してください',
    'auth.error.-1': 'パラメーターエラーまたは検証に失敗しました',
    'auth.error.-2': '試行回数が多すぎるか、ユーザー名が存在します',
    'auth.error.-3': 'メールが存在するか、アカウント/パスワードが間違っています',
    'auth.error.-4': 'アカウントが凍結されています',
    'auth.error.-5': 'デバイスまたは IP がブロックされています / メールが無効です',
    'auth.error.-6': 'パスワードが無効です（32 文字の MD5 が必要）',
    'auth.error.-7': 'デバイスがブロックされています',
    'auth.error.md5': 'パスワードは 32 文字の MD5 を入力してください',
    'auth.submit.signIn': 'ログイン',
    'auth.submit.signUp': 'アカウントを作成',
    'auth.submit.loading': '少々お待ちください...',
    'auth.close': '閉じる',
    'rank.eyebrow': 'プレイヤー',
    'rank.title': 'グローバルランキング',
    'rank.desc':
      'モード別の EXP・MM ランキング。',
    'rank.about.title': '概要',
    'rank.about.desc': '各モードのトップ200プレイヤーをスコア順位とMM順位で表示します。',
    'rank.selectMode': 'モードを選択',
    'rank.table.player': 'プレイヤー',
    'rank.table.score.mm': 'MM スコア',
    'rank.table.score.exp': 'EXP',
    'rank.table.stats': 'ステータス',
    'rank.table.empty': 'データがありません',
    'rank.table.showing': '{{count}} 人を表示中',
    'rank.table.loadMore': 'さらに読み込む',
    'rank.table.loading': '読み込み中...',
    'rank.error.fetch': 'ランキングを取得できません。時間をおいて再試行してください',
    'rank.error.network': 'ランキングを取得できません。ネットワークを確認して再試行してください',
    'rank.meta.level': 'Lv. {{value}}',
    'rank.meta.play': 'プレイ {{value}}',
    'rank.meta.acc': 'Acc {{value}}',
    'rank.meta.combo': 'コンボ {{value}}',
    'mode.key': 'Key',
    'mode.catch': 'Catch',
    'mode.taiko': '太鼓',
    'mode.pad': 'Pad',
    'mode.ring': 'Ring',
    'mode.slide': 'Slide',
    'mode.live': 'Live',
    'mode.cube': 'Cube',
    'song.eyebrow': '楽曲',
    'song.placeholder.title': '読み込み中...',
    'song.placeholder.artist': 'アーティスト読み込み中...',
    'song.error.missingId': '楽曲 ID がありません',
    'song.error.load': '楽曲情報を取得できません',
    'song.meta.id': '楽曲 #{{id}}',
    'song.charts.eyebrow': '譜面',
    'song.charts.title': 'この楽曲の譜面',
    'song.charts.creator': '{{name}} 作成',
    'song.charts.creatorUnknown': '作者不明',
    'song.charts.untitled': '無題の譜面',
    'song.charts.loadError': '譜面を読み込めません',
    'song.charts.empty': '譜面がありません',
    'song.charts.type.official': '公式',
    'song.charts.type.ugc': 'コミュニティ',
    'song.charts.type.beta': 'ベータ',
    'song.charts.type.unknown': 'タイプ {{value}}',
    'song.wiki.eyebrow': 'Wiki',
    'song.wiki.title': '楽曲 Wiki',
    'song.wiki.viewFull': 'Wiki を開く',
    'song.wiki.empty': 'Wiki がまだありません',
    'song.wiki.error': 'Wiki を読み込めません',
    'song.edit.eyebrow': '編集',
    'song.edit.title': '楽曲情報の編集',
    'song.edit.desc': 'タイトル、アーティスト、長さ、BPM、カバーを更新できます。作者または運営のみ保存できます。',
    'song.edit.login': '編集にはサインインが必要です。',
    'song.edit.field.title': 'タイトル',
    'song.edit.field.artist': 'アーティスト',
    'song.edit.field.titleOrg': '原題（任意）',
    'song.edit.field.artistOrg': '原アーティスト（任意）',
    'song.edit.field.length': '長さ（秒）',
    'song.edit.field.bpm': 'BPM',
    'song.edit.lengthHint': '秒数または mm:ss',
    'song.edit.save': '変更を保存',
    'song.edit.saving': '保存中...',
    'song.edit.saved': '楽曲情報を保存しました',
    'song.edit.open': '編集する',
    'song.edit.back': '楽曲ページに戻る',
    'song.edit.error.required': 'タイトル、アーティスト、長さ、BPM を入力してください。',
    'song.edit.error.length': '長さは 0 より大きい秒数で入力してください。',
    'song.edit.error.bpm': 'BPM は 0 より大きい数値で入力してください。',
    'song.edit.error.permission': 'この楽曲を編集する権限がありません。',
    'song.edit.error.duplicate': '同じタイトルとアーティストの楽曲が既に存在します。',
    'song.edit.error.invalidChar': 'タイトルまたはアーティストに特殊文字が多すぎます。',
    'song.edit.error.save': '保存に失敗しました。時間をおいて再試行してください。',
    'song.edit.cover.title': 'カバー',
    'song.edit.cover.hint': 'JPG/PNG のみ。アップロードすると既存のカバーを置き換えます。',
    'song.edit.cover.select': '画像を選択',
    'song.edit.cover.upload': 'カバーをアップロード',
    'song.edit.cover.uploading': 'アップロード中...',
    'song.edit.cover.success': 'カバーをアップロードしました。反映まで数秒かかる場合があります。',
    'song.edit.cover.error': 'カバーをアップロードできませんでした。',
    'song.edit.cover.needFile': '先に JPG/PNG を選択してください。',
    'chart.eyebrow': '譜面',
    'chart.placeholder.title': '譜面情報を読み込み中...',
    'chart.placeholder.artist': 'アーティストを読み込み中...',
    'chart.placeholder.version': 'バージョンを読み込み中...',
    'chart.placeholder.creator': '作者を読み込み中...',
    'chart.error.missingId': '譜面 ID がありません',
    'chart.error.load': '譜面情報を取得できません',
    'chart.meta.song': '楽曲 #{{id}}',
    'chart.meta.level': 'レベル {{level}}',
    'chart.meta.creator': '譜面作者',
    'chart.score.title': 'ユーザー評価',
    'chart.score.value': '{{value}} / 5',
    'chart.score.percent': '{{value}}% 好評',
    'chart.score.like': 'いいね',
    'chart.score.dislike': 'よくない',
    'chart.tab.ranking': 'ランキング',
    'chart.tab.comment': 'コメント',
    'chart.tab.donate': '寄付',
    'chart.tab.wiki': 'Wiki',
    'chart.ranking.error': 'ランキングを読み込めません',
    'chart.ranking.empty': 'まだスコアがありません',
    'chart.ranking.player': 'プレイヤー',
    'chart.ranking.score': 'スコア',
    'chart.ranking.acc': '精度',
    'chart.ranking.combo': 'コンボ',
    'chart.ranking.time': '時間',
    'chart.ranking.unknown': '不明',
    'chart.ranking.platform': 'プラットフォーム',
    'chart.ranking.platform.mobile': 'モバイル',
    'chart.ranking.platform.pc': 'PC',
    'chart.ranking.sort': '並び替え',
    'chart.ranking.sort.score': 'スコア順',
    'chart.ranking.sort.combo': 'コンボ順',
    'chart.ranking.sort.acc': '精度順',
    'chart.ranking.modFilter': 'フィルター',
    'chart.ranking.mod.all': 'すべてのスコア',
    'chart.ranking.noMod': 'MOD なし',
    'chart.ranking.noSpeed': '速度 MOD なし',
    'chart.ranking.noModNoSpeed': 'MODなし＋速度変更なし',
    'chart.donate.send': '寄付',
    'chart.donate.sending': '送信中...',
    'chart.donate.empty': '寄付はまだありません',
    'chart.donate.error': '寄付に失敗しました',
    'chart.donate.invalid': '正しい数値を入力してください',
    'chart.donate.unknown': '匿名',
    'chart.donate.gold': '{{value}} ゴールド',
    'chart.wiki.error': 'Wiki を読み込めません',
    'chart.wiki.empty': 'Wiki はまだありません',
    'player.eyebrow': 'プレイヤー',
    'player.placeholder.name': 'プレイヤー読込中...',
    'player.error.missingId': 'ユーザー ID がありません',
    'player.error.info': 'プレイヤー情報を取得できません',
    'player.error.activity': 'アクティビティを取得できません',
    'player.error.charts': '譜面リストを取得できません',
    'player.error.rank': 'ランキングを取得できません',
    'player.wikiLink': 'Wiki を開く',
    'player.joined': '{{time}} に参加',
    'player.loading': 'プレイヤーを読み込み中...',
    'player.stat.level': 'レベル',
    'player.stat.playcount': 'プレイ回数',
    'player.stat.acc': '精度',
    'player.stat.combo': '最大コンボ',
    'player.stat.mmr': 'MMR',
    'player.meta.gold': 'ゴールド {{value}}',
    'player.meta.exp': 'EXP {{value}}',
    'player.meta.playcount': '{{value}} 回プレイ',
    'player.section.activity': 'アクティビティ',
    'player.section.activityTitle': '最近の動き',
    'player.activity.empty': 'アクティビティがありません',
    'player.activity.unknown': '内容なし',
    'player.activity.link': '見る',
    'player.section.charts': '譜面',
    'player.section.chartsTitle': 'この作者の譜面',
    'player.charts.empty': 'このプレイヤーの譜面はありません',
    'player.charts.untitled': '無題の譜面',
    'player.charts.unknown': '作者不明',
    'player.section.rank': 'ランキング',
    'player.section.rankTitle': 'パフォーマンス',
    'player.rank.empty': 'ランキングデータなし',
    'player.rank.position': '{{value}} 位',
    'player.rank.unknown': '不明',
    'player.section.wiki': 'Wiki',
    'player.section.wikiTitle': 'プレイヤー Wiki',
    'player.tab.activity': 'アクティビティ',
    'player.tab.charts': '譜面',
    'player.tab.rank': 'ランキング',
    'player.tab.wiki': 'Wiki',
    'player.wiki.desc': 'プレイヤーの Wiki を開いてプロフィールを確認しましょう。',
    'player.wiki.error': 'プレイヤーの Wiki を読み込めませんでした',
    'player.wiki.empty': 'このプレイヤーの Wiki はまだありません。',
    'comment.label': 'コメント',
    'comment.placeholder': '感想を共有しましょう...',
    'comment.submit': '投稿',
    'comment.submitting': '投稿中...',
    'comment.loading': '読み込み中...',
    'comment.loadMore': 'もっと読む',
    'comment.empty': 'コメントはまだありません',
    'comment.error.fetch': 'コメントを取得できません',
    'comment.error.post': '投稿に失敗しました',
    'comment.error.delete': '削除に失敗しました',
    'comment.error.auth': 'コメントするにはログインしてください',
    'comment.error.empty': '内容を入力してください',
    'comment.user.unknown': 'ゲスト',
    'comment.currentUser': 'UID {{uid}}',
    'comment.delete': '削除',
    'comment.deleting': '削除中...',
  },
}

const normalizeLocale = (lang?: string | null): Locale | undefined => {
  if (!lang) return undefined
  const lower = lang.toLowerCase()
  if (lower.startsWith('zh')) return 'zh-CN'
  if (lower.startsWith('ja')) return 'ja'
  if (lower.startsWith('en')) return 'en-US'
  return undefined
}

const detectLocale = (): Locale => {
  if (typeof window === 'undefined') return fallbackLocale
  try {
    const stored = localStorage.getItem(storageKey)
    const storedLocale = normalizeLocale(stored)
    if (storedLocale) return storedLocale
  } catch {
    // ignore storage errors
  }

  const langs = Array.isArray(navigator.languages) && navigator.languages.length ? navigator.languages : []
  const checks = [...langs, navigator.language]
  for (const item of checks) {
    const detected = normalizeLocale(item)
    if (detected) return detected
  }
  return fallbackLocale
}

const formatMessage = (template: string, vars?: TranslateVars) => {
  if (!vars) return template
  let output = template
  Object.entries(vars).forEach(([key, value]) => {
    output = output.replace(new RegExp(`{{${key}}}`, 'g'), String(value))
  })
  return output
}

type I18nContextValue = {
  lang: Locale
  setLang: (locale: Locale) => void
  t: (key: string, vars?: TranslateVars) => string
  locales: Locale[]
}

const I18nContext = createContext<I18nContextValue | undefined>(undefined)

export function I18nProvider({ children }: { children: ReactNode }) {
  const [lang, setLangState] = useState<Locale>(() => detectLocale())

  useEffect(() => {
    try {
      document.documentElement.lang = lang
      localStorage.setItem(storageKey, lang)
    } catch {
      // ignore
    }
  }, [lang])

  const setLang = (locale: Locale) => {
    setLangState(locale)
    try {
      localStorage.setItem(storageKey, locale)
    } catch {
      // ignore
    }
  }

  const t = useMemo(() => {
    return (key: string, vars?: TranslateVars) => {
      const template = translations[lang]?.[key] ?? translations[fallbackLocale][key] ?? key
      return formatMessage(template, vars)
    }
  }, [lang])

  const value = useMemo(
    () => ({
      lang,
      setLang,
      t,
      locales: supportedLocales,
    }),
    [lang, t],
  )

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>
}

// eslint-disable-next-line react-refresh/only-export-components
export const useI18n = () => {
  const ctx = useContext(I18nContext)
  if (!ctx) {
    throw new Error('useI18n must be used within I18nProvider')
  }
  return ctx
}
